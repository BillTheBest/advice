<!DOCTYPE html>
<html>
<head>
  <title>advice.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="doc-style.css" />
  <script src="doc-filelist.js"></script>
  <script>
    var relativeDir = "", thisFile = "advice.js", defaultSidebar = true;
  </script>
  <script src="doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#advice">ADVICE</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="advice">
  <h1>
    <a href="#advice" name="advice" class="pilcrow">&#182;</a>
    ADVICE
  </h1>
</div>

  </div>
  <div class="body">
  </div>
</div>

<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">version</div>
    <div class="dox_tag_detail">
      <span>0.2</span>
    </div>
    <div class="dox_tag_title">fileOverview</div>
    <div class="dox_tag_detail">
      <span>Based on the Advice functional mixin library by Angus Croll. Adds functional mixins to an object.
Advice offers a number of ways to modify methods and properties on an object.  It makes it possible to reuse code and compose together functionality to create an object behavior.
Copyright 2015 Dataminr
Licensed under The MIT License
<a href='http://opensource.org/licenses/MIT'>http://opensource.org/licenses/MIT</a>
work derived from <a href='https://github.com/twitter/flight/blob/master/lib/advice.js'>https://github.com/twitter/flight/blob/master/lib/advice.js</a></span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">factory</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">define</span><span class="p">([</span><span class="s1">&#39;mutation&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">root</span><span class="p">.</span><span class="nx">Advice</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">_</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">root</span><span class="p">.</span><span class="nx">Advice</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">root</span><span class="p">.</span><span class="nx">Advice</span> <span class="o">=</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">root</span><span class="p">.</span><span class="nx">_</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}(</span><span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">_</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>adds mixins to an object</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">mixInto</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mixins</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>used to saved applied mixins</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">this</span><span class="p">.</span><span class="nx">mixedIn</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixedIn</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">__super__</span>
            <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixedOptions</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">mixedOptions</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">mixedOptions</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixedOptions</span><span class="p">)</span> <span class="o">||</span> <span class="p">{};</span>
        <span class="p">}</span>
        <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixedOptions</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>if only one passed in make it an array</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">mixins</span><span class="p">))</span>
            <span class="nx">mixins</span> <span class="o">=</span> <span class="p">[</span><span class="nx">mixins</span><span class="p">];</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>if an array then run each mixin and save to mixedIn array</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">mixins</span> <span class="o">=</span> <span class="nx">_</span><span class="p">(</span><span class="nx">mixins</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">mixin</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Boolean</span><span class="p">(</span><span class="nx">mixin</span><span class="p">))</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Missing mixin at &#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">className</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">mixin</span><span class="p">))</span> <span class="k">return</span> <span class="nx">mixin</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixedIn</span><span class="p">,</span> <span class="nx">mixin</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">mixedIn</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">mixin</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">mixin</span><span class="p">)</span> <span class="k">return</span> <span class="nx">mixin</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixedOptions</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span> <span class="k">this</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>if we have an object (can be returned by functions) - use them</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">_</span><span class="p">(</span><span class="nx">mixins</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">mixin</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mixin</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

            <span class="nx">mixin</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">mixin</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>call the reserved keywords</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">_</span><span class="p">([</span>
                <span class="s1">&#39;mixin&#39;</span><span class="p">,</span>
                <span class="s1">&#39;around&#39;</span><span class="p">,</span>
                <span class="s1">&#39;after&#39;</span><span class="p">,</span>
                <span class="s1">&#39;before&#39;</span><span class="p">,</span>
                <span class="s1">&#39;clobber&#39;</span><span class="p">,</span>
                <span class="s1">&#39;addToObj&#39;</span><span class="p">,</span>
                <span class="s1">&#39;setDefaults&#39;</span>
            <span class="p">]).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="s1">&#39;mixin&#39;</span><span class="p">)</span>
                        <span class="k">this</span><span class="p">[</span><span class="nx">key</span><span class="p">](</span><span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixedOptions</span><span class="p">);</span>
                    <span class="k">else</span>
                        <span class="k">this</span><span class="p">[</span><span class="nx">key</span><span class="p">](</span><span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
                    <span class="k">delete</span> <span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="k">this</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>on the remaining keywords, guess how to add them in</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">mixin</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>if it's a function then put it after</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>if it's an object then add it to any existing one</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
                    <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">addToObj</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>else change the value</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">clobber</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">mixin</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">},</span> <span class="k">this</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>chaining</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">addMixin</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mixin</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">mixin</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">hasMixin</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mixin</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">mixins</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixedIn</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">mixedIn</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">mixins</span><span class="p">,</span> <span class="nx">mixin</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">Advice</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>calls the wrapped function with base functions as first argument</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">around</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">wrapped</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
                <span class="k">return</span> <span class="nx">wrapped</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="k">this</span><span class="p">)].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">args</span><span class="p">));</span>
            <span class="p">};</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>will call the new function before the old one with same arguments</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">before</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">before</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">around</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="nx">orig</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span>
                    <span class="nx">beforeFn</span><span class="p">;</span>

                <span class="nx">beforeFn</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">before</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">before</span> <span class="o">:</span> <span class="nx">before</span><span class="p">.</span><span class="nx">obj</span><span class="p">[</span><span class="nx">before</span><span class="p">.</span><span class="nx">fnName</span><span class="p">];</span>
                <span class="nx">beforeFn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
                <span class="k">return</span> <span class="p">(</span><span class="nx">orig</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>will call the new function after the old one with same arguments</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">after</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">after</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">around</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="nx">orig</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span>
                    <span class="nx">afterFn</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>this is a separate statement for debugging purposes.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">(</span><span class="nx">orig</span><span class="p">.</span><span class="nx">unbound</span> <span class="o">||</span> <span class="nx">orig</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>

                <span class="nx">afterFn</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">after</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">after</span> <span class="o">:</span> <span class="nx">after</span><span class="p">.</span><span class="nx">obj</span><span class="p">[</span><span class="nx">after</span><span class="p">.</span><span class="nx">fnName</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">afterFn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
                <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>if it exists then overwrite</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">clobber</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">extBase</span> <span class="o">=</span> <span class="nx">base</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">extBase</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span>
                <span class="nx">extBase</span> <span class="o">=</span> <span class="nx">base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
                <span class="nx">key</span> <span class="o">=</span> <span class="p">{};</span>
                <span class="nx">key</span><span class="p">[</span><span class="nx">temp</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">extBase</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">base</span><span class="p">;</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>will add values to an existing object (good for 'events')</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">addToObj</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">extBase</span> <span class="o">=</span> <span class="nx">base</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">extBase</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span>
                <span class="nx">extBase</span> <span class="o">=</span> <span class="nx">base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">extBase</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extendWith</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">Advice</span><span class="p">.</span><span class="nx">findVal</span><span class="p">(</span><span class="nx">extBase</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="o">||</span> <span class="p">{},</span> <span class="nx">val</span><span class="p">);</span>
            <span class="p">});</span>
            <span class="k">return</span> <span class="nx">base</span><span class="p">;</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>will set only if doesn't exist</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">setDefaults</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">extBase</span> <span class="o">=</span> <span class="nx">base</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">extBase</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span>
                <span class="nx">extBase</span> <span class="o">=</span> <span class="nx">base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Advice</span><span class="p">.</span><span class="nx">findVal</span><span class="p">(</span><span class="nx">extBase</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span>
                    <span class="nx">extBase</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
            <span class="p">});</span>
            <span class="k">return</span> <span class="nx">base</span><span class="p">;</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>find a value in a prototype chain</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">findVal</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span>
                <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
        <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>adds advice functions to an object</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">addAdvice</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>adds before, after and around</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="p">[</span><span class="s1">&#39;before&#39;</span><span class="p">,</span> <span class="s1">&#39;after&#39;</span><span class="p">,</span> <span class="s1">&#39;around&#39;</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">obj</span><span class="p">[</span><span class="nx">m</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>if an object is passed in then split that in to individual calls</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">method</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">method</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">this</span><span class="p">[</span><span class="nx">m</span><span class="p">](</span><span class="nx">key</span><span class="p">,</span> <span class="nx">method</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
                        <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
                        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                    <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>functions should go on a prototype if a constructor passed in</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="kd">var</span> <span class="nx">base</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">base</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span>
                        <span class="nx">base</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>find original function in the prototype chain</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="kd">var</span> <span class="nx">orig</span> <span class="o">=</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">findVal</span><span class="p">(</span><span class="nx">base</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>use an identity function if none found</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">orig</span> <span class="o">!=</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">m</span> <span class="o">!=</span> <span class="s1">&#39;around&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">base</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
                            <span class="k">return</span> <span class="k">this</span>
                        <span class="p">}</span>
                        <span class="nx">orig</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nx">base</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Advice</span><span class="p">[</span><span class="nx">m</span><span class="p">](</span><span class="nx">orig</span><span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>chaining</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
                <span class="p">};</span>
            <span class="p">});</span>

            <span class="kd">var</span> <span class="nx">callWithThis</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
            <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>add in other functions</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">addMixin</span> <span class="o">=</span> <span class="nx">addMixin</span><span class="p">;</span>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">mixin</span> <span class="o">=</span> <span class="nx">mixInto</span><span class="p">;</span>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">hasMixin</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasMixin</span> <span class="o">=</span> <span class="nx">hasMixin</span><span class="p">;</span>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">addToObj</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">callWithThis</span><span class="p">,</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">addToObj</span><span class="p">);</span>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">setDefaults</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">callWithThis</span><span class="p">,</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">setDefaults</span><span class="p">);</span>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">findVal</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">callWithThis</span><span class="p">,</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">findVal</span><span class="p">);</span>
            <span class="nx">obj</span><span class="p">.</span><span class="nx">clobber</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">callWithThis</span><span class="p">,</span> <span class="nx">Advice</span><span class="p">.</span><span class="nx">clobber</span><span class="p">);</span>

        <span class="p">}</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="nx">Advice</span><span class="p">;</span>

<span class="p">}));</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
